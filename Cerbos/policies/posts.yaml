apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: posts
  rules:
  - actions: ["read", "create"]
    effect: EFFECT_ALLOW
    roles:
      - admin
      - user

  - actions: ["update", "delete"]
    effect: EFFECT_ALLOW
    roles:
      - admin

  - actions: ["update", "delete"]
    effect: EFFECT_ALLOW
    roles:
      - user
    condition:
      match:
        expr: request.principal.attr.oid == request.resource.attr.authorId
