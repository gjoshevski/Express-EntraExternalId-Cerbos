apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: posts
  rules:
  # Admins can do all actions
  - actions: ["*"]
    effect: EFFECT_ALLOW
    roles:
      - admin
    condition:
      match:
        expr: request.resource.attr.organizationId == request.principal.attr.organizationId

  # Users in the Sales department can read and create contacts
  - actions: ["read", "create"]
    effect: EFFECT_ALLOW
    roles:
      - user
    condition:
      match:
        expr: request.principal.attr.department == "Sales"
